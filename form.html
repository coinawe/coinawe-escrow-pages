<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Form Buat Escrow</title>
  <style>
    body {
      background-color: #0f172a;
      color: #38bdf8;
      font-family: 'Segoe UI', sans-serif;
      padding: 20px;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }
    select.lang-switch {
      background-color: #1e293b;
      color: #e2e8f0;
      border: 1px solid #334155;
      padding: 6px;
      border-radius: 6px;
    }
    h2 {
      text-align: center;
    }
    label {
      display: block;
      margin-top: 10px;
      margin-bottom: 4px;
    }
    input, select {
      background-color: #1e293b;
      color: #e2e8f0;
      border: 1px solid #334155;
      padding: 10px;
      width: 100%;
      border-radius: 6px;
      margin-bottom: 12px;
    }
    button {
      background: linear-gradient(90deg, #06b6d4, #3b82f6);
      color: #0f172a;
      font-weight: bold;
      padding: 12px;
      width: 100%;
      border: none;
      border-radius: 8px;
      box-shadow: 0 0 8px #38bdf8;
      transition: all 0.3s ease;
      margin-bottom: 10px;
    }
    button:hover {
      box-shadow: 0 0 16px #38bdf8;
      transform: scale(1.02);
    }
    .btn-back {
      background: #1e293b;
      color: #e2e8f0;
      border: 1px solid #334155;
    }
    .btn-back:hover {
      background: #334155;
    }
    #spinner {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }
    .loader {
      border: 6px solid #f3f3f3;
      border-top: 6px solid #38bdf8;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    form {
      max-width: 600px;
      margin: auto;
      animation: fadeIn 0.6s ease-in-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div id="spinner"><div class="loader"></div></div>
  <header>
    <h2 id="form-title">üöÄ Formulir Buat Escrow</h2>
    <select class="lang-switch" onchange="setLanguage(this.value)">
      <option value="id">üåê Bahasa</option>
      <option value="en">English</option>
      <option value="ru">–†—É—Å—Å–∫–∏–π</option>
    </select>
  </header>

  <form 
    action="https://script.google.com/macros/s/AKfycbywHuDI_p6ZrFJakBxZbCd4fhmc0sVeQj4vVQkSgOfP39XJXr9tbs7M0SL8VqpPjVyZ_w/exec" 
    method="post"
    onsubmit="return validateForm()"
  >
    <label for="buyer" id="label-buyer"></label>
    <input id="buyer" name="buyer" required placeholder="@username" />

    <label for="seller" id="label-seller"></label>
    <input id="seller" name="seller" required placeholder="@username" />

    <label for="item" id="label-item"></label>
    <input id="item" name="item" required placeholder="Logo Design / Layanan" />

    <label for="amount" id="label-amount"></label>
    <input id="amount" name="amount" type="number" min="1" required placeholder="100" />

    <label for="token" id="label-token"></label>
    <select id="token" name="token" required>
      <option value="">-- Select Token --</option>
      <option value="TON">TON</option>
      <option value="AWEWE">AWEWE</option>
      <option value="USDT">USDT</option>
      <option value="BNB">BNB</option>
      <option value="ETH">ETH</option>
      <option value="BTC">BTC</option>
      <option value="IDR">IDR (Rupiah)</option>
    </select>

    <button type="submit" id="submit-button"></button>
    <button type="button" class="btn-back" onclick="goBack()" id="back-button"></button>
  </form>

  <script>
    window.addEventListener("load", () => {
      document.getElementById("spinner").style.display = "none";
    });

    const translations = {
      id: {
        title: "üöÄ Formulir Buat Escrow",
        buyer: "Username Pembeli:",
        seller: "Username Penjual:",
        item: "Item / Layanan:",
        amount: "Jumlah (Nominal):",
        token: "Token yang Digunakan:",
        submit: "Kirim",
        back: "Kembali",
        confirm: "Apakah semua data sudah benar?"
      },
      en: {
        title: "üöÄ Create Escrow Form",
        buyer: "Buyer Username:",
        seller: "Seller Username:",
        item: "Item / Service:",
        amount: "Amount:",
        token: "Token Used:",
        submit: "Submit",
        back: "Back",
        confirm: "Is all data correct?"
      },
      ru: {
        title: "üöÄ –§–æ—Ä–º–∞ –≠—Å–∫—Ä–æ—É",
        buyer: "–ò–º—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—è:",
        seller: "–ò–º—è –ø—Ä–æ–¥–∞–≤—Ü–∞:",
        item: "–¢–æ–≤–∞—Ä / –£—Å–ª—É–≥–∞:",
        amount: "–°—É–º–º–∞:",
        token: "–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–π —Ç–æ–∫–µ–Ω:",
        submit: "–û—Ç–ø—Ä–∞–≤–∏—Ç—å",
        back: "–ù–∞–∑–∞–¥",
        confirm: "–í—Å–µ –¥–∞–Ω–Ω—ã–µ –≤–µ—Ä–Ω—ã?"
      }
    };

    let currentLang = 'id';
    let confirmText = translations['id'].confirm;

    function setLanguage(lang) {
      currentLang = lang;
      const t = translations[lang] || translations['en'];
      document.getElementById('form-title').innerText = t.title;
      document.getElementById('label-buyer').innerText = t.buyer;
      document.getElementById('label-seller').innerText = t.seller;
      document.getElementById('label-item').innerText = t.item;
      document.getElementById('label-amount').innerText = t.amount;
      document.getElementById('label-token').innerText = t.token;
      document.getElementById('submit-button').innerText = t.submit;
      document.getElementById('back-button').innerText = "‚¨Ö " + t.back;
      confirmText = t.confirm;
    }

    function goBack() {
      window.history.back();
    }

    function validateForm() {
      const amount = parseFloat(document.getElementById("amount").value);
      if (isNaN(amount) || amount <= 0) {
        alert("Nominal harus lebih dari 0");
        return false;
      }
      return confirm(confirmText);
    }

    const browserLang = navigator.language.slice(0, 2);
    setLanguage(['id', 'en', 'ru'].includes(browserLang) ? browserLang
